function prompt_yverling_precmd {
  setopt LOCAL_OPTIONS
  unsetopt XTRACE KSH_ARRAYS

  # Get Git repository information.
  if (( $+functions[git-info] )); then
    git-info
  fi
}

function prompt_yverling_setup {
  setopt LOCAL_OPTIONS
  unsetopt XTRACE KSH_ARRAYS

  prompt_opts=(cr percent subst)

  # Add hook for calling git-info before each command.
  autoload -Uz add-zsh-hook
  add-zsh-hook precmd prompt_yverling_precmd

  # Git formatting
  zstyle ':prezto:module:git:info:branch' format '%F{magenta}%b%f'
  zstyle ':prezto:module:git:info:remote' format ' %F{cyan}%R%f'

  zstyle ':prezto:module:git:info:ahead' format ' %F{green}>[%A]%f'
  zstyle ':prezto:module:git:info:behind' format ' %F{red}<[%B]%f'

  zstyle ':prezto:module:git:info:added' format ' %F{green}+[%a]%f'
  zstyle ':prezto:module:git:info:deleted' format ' %F{red}-[%d]%f'
  zstyle ':prezto:module:git:info:modified' format ' %F{red}*[%m]%f'
  zstyle ':prezto:module:git:info:untracked' format ' %F{yellow}?[%u]%f'

  zstyle ':prezto:module:git:info:stashed' format ' %F{blue}$[%S]%f'

  zstyle ':prezto:module:git:info:unmerged' format ' %F{red}![%U]%f'

  zstyle ':prezto:module:git:info:action' format ' <%F{yellow}%s%f>'

  zstyle ':prezto:module:git:info:keys' format 'prompt' '%A%B%a%d%S%u%m%U (%b ->%R)%s'


 # Main prompt
  PROMPT='%(!.%F{red}.%F{green})%m@%n%f  %F{blue}%~%f $git_info[prompt]
%(!.#.$) '
}

prompt_yverling_setup "$@"
